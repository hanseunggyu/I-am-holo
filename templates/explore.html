{% extends "base.html" %}
{% block title %}내 이상형 찾기{% endblock %}

{% block content %}
<!-- 왼쪽 패널: 소개 및 설명 -->
<div class="panel left">
  <h2>💘 내 이상형 찾기</h2>
  <p>성별과 동물 아이콘으로<br>이상형을 탐색해보세요!</p>
  <img src="https://emojicdn.elk.sh/🧭?style=apple" alt="탐색" style="width: 80px; margin-top: 30px;">
</div>

<!-- 오른쪽 패널: 검색 + 결과 -->
<div class="panel right" style="display: flex; flex-direction: column;">

  <!-- 상단 고정: 조건 선택 -->
  <div style="flex-shrink: 0;">
    <h2 class="mb-4">🔍 조건 선택</h2>
    <form method="POST" class="row g-3 mb-4">
      <div class="col-md-6">
        <label class="form-label">성별</label>
        <select name="gender" class="form-select">
          <option value="">전체</option>
          <option value="남자">남자</option>
          <option value="여자">여자</option>
        </select>
      </div>
      <div class="col-md-6">
        <label class="form-label">동물 아이콘</label>
        <select name="animal" class="form-select">
          <option value="">전체</option>
          <option value="사자">🦁 사자</option>
          <option value="토끼">🐰 토끼</option>
          <option value="고양이">🐱 고양이</option>
        </select>
      </div>
      <div class="col-12 text-center">
        <button type="submit" class="btn btn-purple w-100">탐색하기</button>
      </div>
    </form>
  </div>

  <!-- 스크롤 영역: 프로필 리스트 -->
  <div style="overflow-y: auto; max-height: 60vh; padding-right: 10px; flex-grow: 1;">
    {% if profiles %}
      {% for p in profiles %}
        <div class="card mb-3 shadow-sm" style="border-radius: 15px;">
          <div class="card-body">
            <h5 class="card-title">{{ p[2] }} <small class="text-muted">({{ p[12] }})</small></h5>
            {% if p[-1] == 1 %}
              <span class="text-success">🟢 활동중</span>
            {% else %}
              <span class="text-muted">⚫ 휴식중</span>
            {% endif %}
            <p class="card-text">
              <strong>동물:</strong> {{ p[5] }} / <strong>MBTI:</strong> {{ p[3] }}<br>
              <strong>나이:</strong> {{ p[4] }}세 / <strong>사는 곳:</strong> {{ p[6] }}
            </p>

            {% if p[1] in liked_users %}
              <span class="text-danger">❤️ 이미 좋아요함</span>
            {% else %}
              <a href="{{ url_for('like_user', to_email=p[1]) }}" class="btn btn-outline-danger btn-sm">💖 좋아요</a>
            {% endif %}
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p class="text-muted">🙈 조건에 맞는 사용자가 없습니다.</p>
    {% endif %}
  </div>

  <!-- 하단 고정: 대시보드 버튼 -->
  <div class="text-center mt-4" style="flex-shrink: 0;">
    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">← 대시보드로 돌아가기</a>
  </div>

</div>
{% endblock %}